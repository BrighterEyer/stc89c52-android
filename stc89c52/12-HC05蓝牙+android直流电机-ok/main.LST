C51 COMPILER V9.00   MAIN                                                                  12/17/2019 16:27:13 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: G:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /**************************************************************************************
   2          ÊµÑéÏÖÏó£ºÏÂÔØ³ÌÐòºó£¬Ö±Á÷µç»úÐý×ª´óÔ¼5S£¬È»ºóÍ£Ö¹
   3          
   4          ½ÓÏßËµÃ÷£º (¾ßÌå½ÓÏßÍ¼¿É¼û¿ª·¢¹¥ÂÔ¶ÔÓ¦ÊµÑéµÄ¡°ÊµÑéÏÖÏó¡±ÕÂ½Ú)
   5                             1£¬µ¥Æ¬»ú-->ÎåÏßËÄÏà²½½øµç»úÄ£¿é
   6                                          P10-->IN1
   7                             2£¬ÎåÏßËÄÏà²½½øµç»úÄ£¿éÊä³ö-->Ö±Á÷µç»ú
   8                                          5V-->Ö±Á÷µç»úÁ½½ÅÈÎÒâÒ»¸ö
   9                                          O1-->Ö±Á÷µç»úÁ½½ÅÈÎÒâÒ»¸ö
  10          
  11          ×¢ÒâÊÂÏî£º
  12          
  13          
  14          ***************************************************************************************/
  15          
  16          #include "reg52.h"      //´ËÎÄ¼þÖÐ¶¨ÒåÁËµ¥Æ¬»úµÄÒ»Ð©ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷
  17          #include <intrins.h>            //ÒòÎªÒªÓÃµ½×óÓÒÒÆº¯Êý£¬ËùÒÔ¼ÓÈëÕâ¸öÍ·ÎÄ¼þ
  18          
  19          typedef unsigned int u16;
  20          typedef unsigned char u8;
  21          
  22          sbit led1 = P2 ^ 0;//Ö¸Ê¾µÆ0
  23          sbit led2 = P2 ^ 1;//Ö¸Ê¾µÆ1
  24          sbit led3 = P2 ^ 2;//Ö¸Ê¾µÆ2
  25          sbit led4 = P2 ^ 3;//Ö¸Ê¾µÆ3
  26          
  27          u16 tmp;
  28          u16 c = 0;
  29          
  30          sbit moto = P1 ^ 0;
  31          
  32          void init();     //´®¿Ú³õÊ¼»¯
  33          void send(u16 a); //µ¥×Ö½Ú·¢ËÍº¯Êý
  34          void ctrl();     //½ÓÊÕ´¦Àíº¯Êý
  35          void delay(u16 i);
  36          
  37          void main()
  38          {
  39   1      
  40   1              moto = 0;                       //¹Ø±Õµç»ú
  41   1              init();
  42   1              while (1)
  43   1              {
  44   2                      // ÊÇ·ñÓÐÊý¾Ýµ½À´
  45   2                      if (RI == 1)
  46   2                      {
  47   3                              RI = 0;
  48   3                              // ÔÝ´æ½ÓÊÕµ½µÄÊý¾Ý
  49   3                              tmp = SBUF;
  50   3                              ctrl();
  51   3                      }
  52   2              }
  53   1      
  54   1      }
  55          
C51 COMPILER V9.00   MAIN                                                                  12/17/2019 16:27:13 PAGE 2   

  56          
  57          /*******************************************************************************
  58          * º¯ Êý Ãû         : delay
  59          * º¯Êý¹¦ÄÜ                 : ÑÓÊ±º¯Êý£¬i=1Ê±£¬´óÔ¼ÑÓÊ±10us
  60          *******************************************************************************/
  61          void delay(u16 i)
  62          {
  63   1              while (i--);
  64   1      }
  65          
  66          //´®¿Ú³õÊ¼»¯
  67          void init()
  68          {
  69   1              //¹ØÖÐ¶Ï
  70   1              ES = 0;
  71   1              SCON = 0x50;                        // REN=1ÔÊÐí´®ÐÐ½ÓÊÜ×´Ì¬£¬´®¿Ú¹¤×÷Ä£Ê½1,10Î»UART£¨1Î»ÆðÊ¼Î»£¬8Î»Êý¾ÝÎ
             -»£¬1Î»Í£Ö¹Î»£¬ÎÞÆæÅ¼Ð£Ñé£©£¬²¨ÌØÂÊ¿É±ä
  72   1      
  73   1              TMOD = 0x20;                        // ¶¨Ê±Æ÷1¹¤×÷ÓÚ·½Ê½2£¬8Î»×Ô¶¯ÖØÔØÄ£Ê½, ÓÃÓÚ²úÉú²¨ÌØÂÊ
  74   1              TH1 = TL1 = 0xFD;                   // ²¨ÌØÂÊ9600 £¨±¾´Î²âÊÔ²ÉÓÃ¾§ÕñÎª11.0592£©
  75   1      
  76   1              PCON &= 0x7f;                       // ²¨ÌØÂÊ²»±¶Ôö
  77   1              TR1 = 1;                            // ¶¨Ê±Æ÷1¿ªÊ¼¹¤×÷£¬²úÉú²¨ÌØÂÊ
  78   1              //·¢ËÍ±êÖ¾Î»ÖÃ0
  79   1              TI = 0;                             // ½ÓÊÕ±êÖ¾Î»ÖÃ0
  80   1              RI = 0;
  81   1      
  82   1              //EA=0;
  83   1              ES = 1;
  84   1      
  85   1              //³õÊ¼»¯ÉèÖÃ3¸öÖ¸Ê¾µÆÈ«ÁÁ
  86   1              led1 = 0;
  87   1              led2 = 0;
  88   1              led3 = 0;
  89   1      }
  90          
  91          /*ÖÐ¶Ïº¯Êý*/
  92          void Uart() interrupt 4
  93          {
  94   1          u8 d;
  95   1          d=SBUF;        //È¡³ö½ÓÊÜµ½µÄÊý¾Ý
  96   1          RI=0;                         //Çå³ý½ÓÊÜÖÐ¶Ï±êÖ¾Î»
  97   1      }
  98          
  99          //µ¥×Ö½ÚÊý¾Ý·¢ËÍ
 100          void send(u16 a) {
 101   1      //×¢Òâ£ºÈôµ¥Æ¬»úTXD£¨P3.1£©ÎÞÉÏÀ­ÄÜÁ¦£¬±ØÐëÔÚP3.1¶Ë½ÓÉÏÀ­µç×è¡£±¾´Î²âÊÔÐèÒª½ÓÉÏÀ­µç×è
 102   1              SBUF = a;
 103   1              while (!TI);
 104   1              TI = 0;
 105   1      
 106   1      //·¢ËÍÖ¸Ê¾µÆ±êÖ¾£¬Ã¿½ÓÊÕÒ»´Î£¬´ËµÆÁÁÃð½»Ìæ
 107   1              if (c % 2)
 108   1                      led4 = 1;
 109   1              else
 110   1                      led4 = 0;
 111   1              c++;
 112   1      }
 113          
 114          //½ÓÊÕ´¦Àíº¯Êý
 115          void ctrl()
 116          {
C51 COMPILER V9.00   MAIN                                                                  12/17/2019 16:27:13 PAGE 3   

 117   1              u8 i;
 118   1              switch (tmp)
 119   1              {
 120   2              case 1:
 121   2                      led1 = 1;  //¹Ø±ÕµÆ1
 122   2                      moto = 0;                            //¹Ø±Õµç»ú
 123   2                      for (i = 0; i < 100; i++)        //Ñ­»·100´Î£¬Ò²¾ÍÊÇ´óÔ¼5S
 124   2                      {
 125   3                              moto = 1;                        //¿ªÆôµç»ú
 126   3                              delay(5000);         //´óÔ¼ÑÓÊ±50ms
 127   3                      }
 128   2                      moto = 0;                        //¹Ø±Õµç»ú
 129   2      
 130   2                      send(tmp);
 131   2                      break;
 132   2      
 133   2              case 2:
 134   2                      led2 = 1;           //¹Ø±ÕµÆ2
 135   2                      moto = 0;               //¹Ø±Õµç»ú
 136   2                      send(tmp);
 137   2                      break;
 138   2      
 139   2              case 3:
 140   2                      led3 = 1;       //¹Ø±ÕµÆ3
 141   2                      moto = 1;           //¿ªÆôµç»ú
 142   2                      send(tmp);
 143   2                      break;
 144   2      
 145   2              default:
 146   2                      led1 = 0;
 147   2                      led2 = 0;
 148   2                      led3 = 0;
 149   2      
 150   2                      send(tmp);
 151   2              }
 152   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    162    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
